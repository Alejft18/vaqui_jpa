<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/Login.css">
    <link rel="icon" href="/ImagenesPrincipales/logo.png">
    <title>Inicio de sesion</title>
</head>
<body>

<div class="container">
    <img src="/ImagenesVacas/VacaPrincipal.webp" alt="ilustracion vaca">

    <div class="container-form">
        <form onsubmit="validarFormulario(event)">
            <h2 class="form-title">Vaqui</h2>
            <div class="form-container">
                <div class="form-group">
                    <input type="number" id="id" class="form-input" placeholder=" ">
                    <label for="id" class="form-label">Numero de documento</label>
                    <span class="form-line"></span>
                </div>

                <div class="form-group">
                    <input type="password" id="contraseña" class="form-input" placeholder=" ">
                    <label for="contraseña" class="form-label">Contraseña</label>
                    <span class="form-line"></span>
                </div>
            </div>
            <button type="submit" class="iniciar-sesion">Iniciar Sesion</button>
            <div class="hrs">
                <hr>
                <h4>o</h4>
                <hr>
            </div>
            <a href="" class="olvidaste-contraseña">¿Olvidaste tu contraseña?</a>
        </form>

        <div class="servicios">
            <a href="./Servicios.html" class="servicios-a">Adquiere nuestros servicios</a>
        </div>
    </div>
</div>

<script>
    function validarFormulario(event) {
        event.preventDefault(); // Prevenir el envío del formulario por defecto

        // Obtener los valores del formulario
        const id = document.getElementById('id').value;
        const contraseña = document.getElementById('contraseña').value;

        // Validar que los campos no estén vacíos
        if (id.trim() === '' || contraseña.trim() === '') {
            alert('Por favor, ingrese el número de documento y la contraseña.');
            return;
        }

        // Realizar la solicitud AJAX para buscar al usuario por ID
        const url = `http://localhost:8080/buscarUsuario/${id}`;

        fetch(url, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Usuario no encontrado');
            }
            return response.json();
        })
        .then(usuario => {
            // Verificar si la contraseña coincide
            if (usuario.contrasena === contraseña) {
                // Verificar el rol del usuario
                if (usuario.rol === 'empleada') {
                    alert('Inicio de sesión exitoso como empleado');
                    // Redireccionar a la página de empleado después del inicio de sesión
                    window.location.href = '/Empleado/LandingPage.html';
                } else if (usuario.rol === 'Administrador') {
                    alert('Inicio de sesión exitoso como administrador');
                    // Redireccionar a la página de administrador después del inicio de sesión
                    window.location.href = '/Adminstrador/LandingPage.html';
                } else {
                    alert('Rol no reconocido');
                }
            } else {
                alert('Documento y/o contraseña incorrectos');
            }
        })
        .catch(error => {
            alert('Documento y/o contraseña incorrectos');
            console.error('Error:', error);
        });
    }
</script>
</body>
</html>
